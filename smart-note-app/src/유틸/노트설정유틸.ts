import { 노트타입, 폴더설정타입, 노트설정타입 } from '../타입';

/**
 * 노트의 실제 설정을 가져옵니다 (노트별 설정이 있으면 우선, 없으면 폴더 설정 사용)
 */
export const 노트설정가져오기 = (노트: 노트타입 | null, 폴더설정: 폴더설정타입) => {
  if (!노트) {
    return 폴더설정;
  }

  const 노트설정 = 노트.노트설정 || {};

  return {
    시간표시여부: 노트설정.시간표시여부 !== undefined ? 노트설정.시간표시여부 : 폴더설정.시간표시여부,
    입력방식: 노트설정.입력방식 !== undefined ? 노트설정.입력방식 : 폴더설정.입력방식,
    하위입력활성화: 노트설정.하위입력활성화 !== undefined ? 노트설정.하위입력활성화 : 폴더설정.하위입력활성화,
    카테고리목록: 노트설정.카테고리목록 !== undefined ? 노트설정.카테고리목록 : 폴더설정.카테고리목록,
    캐릭터목록: 노트설정.캐릭터목록 !== undefined ? 노트설정.캐릭터목록 : 폴더설정.캐릭터목록,
    // 나머지 폴더 설정들도 포함
    동적카테고리사용: 폴더설정.동적카테고리사용,
    카테고리조합설정: 폴더설정.카테고리조합설정,
    카테고리자동선택설정: 폴더설정.카테고리자동선택설정
  };
};

/**
 * 노트가 폴더 기본 설정을 사용하는지 확인합니다
 */
export const 폴더기본설정사용중인지확인 = (노트: 노트타입 | null): boolean => {
  if (!노트 || !노트.노트설정) {
    return true;
  }

  const 설정 = 노트.노트설정;
  return 설정.시간표시여부 === undefined && 
         설정.입력방식 === undefined && 
         설정.하위입력활성화 === undefined &&
         설정.카테고리목록 === undefined &&
         설정.캐릭터목록 === undefined;
};

/**
 * 노트별 설정이 적용된 필드 목록을 반환합니다
 */
export const 커스터마이즈된필드목록 = (노트: 노트타입 | null): string[] => {
  if (!노트 || !노트.노트설정) {
    return [];
  }

  const 설정 = 노트.노트설정;
  const 필드목록: string[] = [];

  if (설정.시간표시여부 !== undefined) 필드목록.push('시간표시여부');
  if (설정.입력방식 !== undefined) 필드목록.push('입력방식');
  if (설정.하위입력활성화 !== undefined) 필드목록.push('하위입력활성화');
  if (설정.카테고리목록 !== undefined) 필드목록.push('카테고리목록');
  if (설정.캐릭터목록 !== undefined) 필드목록.push('캐릭터목록');

  return 필드목록;
};