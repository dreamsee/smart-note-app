<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>로컬스토리지 디버깅</title>
</head>
<body>
  <h1>로컬스토리지 디버깅</h1>
  
  <h2>원본문서들</h2>
  <pre id="originalDocs"></pre>
  
  <h2>수정된문서들</h2>
  <pre id="modifiedDocs"></pre>
  
  <button onclick="loadData()">데이터 로드</button>
  <button onclick="createSampleData()">샘플 데이터 생성</button>
  <button onclick="clearData()">데이터 삭제</button>
  <button onclick="testModifiedDoc()">수정된 문서 테스트</button>
  
  <script>
    function loadData() {
      const originalDocs = JSON.parse(localStorage.getItem('originalDocuments') || '[]');
      const modifiedDocs = JSON.parse(localStorage.getItem('modifiedDocuments') || '[]');
      
      document.getElementById('originalDocs').textContent = JSON.stringify(originalDocs, null, 2);
      document.getElementById('modifiedDocs').textContent = JSON.stringify(modifiedDocs, null, 2);
      
      console.log('원본문서들:', originalDocs);
      console.log('수정된문서들:', modifiedDocs);
    }
    
    function createSampleData() {
      const sampleOriginal = {
        id: 1,
        title: "테스트 원본",
        content: "이것은 원본 텍스트입니다.\n\n여러 줄로 구성되어 있습니다.",
        createdAt: new Date().toISOString()
      };
      
      const sampleModified = {
        id: 1,
        title: "테스트 수정본",
        content: "이것은 수정된 텍스트입니다.\n\n여러 줄로 구성되어 있으며, 내용이 변경되었습니다.",
        originalId: 1,
        regionData: {
          categories: [
            { id: 'default', name: '기본 카테고리', color: '#6b7280', isCollapsed: false, order: 0 },
            { id: 'important', name: '중요', color: '#ef4444', isCollapsed: false, order: 1 }
          ],
          regions: [
            {
              id: 'region1',
              name: '첫 번째 영역',
              startLine: 1,
              startChar: 0,
              endLine: 1,
              endChar: 10,
              originalValue: '이것은 원본',
              modifiedValue: '이것은 수정된',
              categoryId: 'important',
              type: 'single'
            }
          ],
          lineGroups: [
            {
              id: 'group1',
              name: '그룹 1',
              lines: [1, 2],
              isVisible: true,
              isCollapsed: false,
              color: '#3b82f6'
            }
          ]
        },
        createdAt: new Date().toISOString()
      };
      
      localStorage.setItem('originalDocuments', JSON.stringify([sampleOriginal]));
      localStorage.setItem('modifiedDocuments', JSON.stringify([sampleModified]));
      
      loadData();
    }
    
    function clearData() {
      localStorage.removeItem('originalDocuments');
      localStorage.removeItem('modifiedDocuments');
      loadData();
    }
    
    function testModifiedDoc() {
      const originalDocs = JSON.parse(localStorage.getItem('originalDocuments') || '[]');
      const modifiedDocs = JSON.parse(localStorage.getItem('modifiedDocuments') || '[]');
      
      const jsonData = {
        원본문서목록: originalDocs,
        수정된문서목록: modifiedDocs
      };
      
      console.log('JSON 내보내기 데이터:', jsonData);
      
      // JSON 파일로 다운로드
      const blob = new Blob([JSON.stringify(jsonData, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'test-export.json';
      a.click();
      URL.revokeObjectURL(url);
    }
    
    // 페이지 로드 시 데이터 로드
    window.onload = loadData;
  </script>
</body>
</html>