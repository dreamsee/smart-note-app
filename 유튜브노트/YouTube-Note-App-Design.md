# YouTube 노트 앱 설계 문서

## 📋 프로젝트 개요
YouTube 영상을 시청하면서 떠오르는 아이디어나 유용한 정보를 내가 원하는 형태로 가공하기 위한 웹 애플리케이션

### 핵심 목적
- 영상 시청 중 떠오른 아이디어를 즉시 기록
- 타임스탬프로 특정 순간과 아이디어 연결
- 나중에 해당 시점으로 쉽게 접근 가능

## ✅ 현재 구현된 기능

### 기본 기능
- [x] YouTube 영상 플레이어 (IFrame API)
- [x] 영상 URL 입력 및 검색 기능
- [x] 타임스탬프 추가 ([HH:MM:SS] 형식)
- [x] 타임스탬프 클릭시 해당 시점으로 이동
- [x] 자유로운 텍스트 노트 작성
- [x] 재생 속도 조절 (0.2x, 0.5x, 1x, 1.2x, 1.5x, 2.5x)

### 기술 스택
- Frontend: React + TypeScript + Vite
- UI: shadcn/ui + Tailwind CSS
- Backend: Express.js
- YouTube API 연동 (서버사이드에서 안전하게 처리)

## 🚨 현재 확인된 문제점

### 1. 레이아웃 문제 (우선순위: 높음)
- **문제**: 검색 기능이 중앙에 위치해서 영상과 노트 작성 공간이 너무 멀음
- **영향**: 영상을 보면서 노트를 쓸 때 시선 이동이 많이 필요
- **해결 방향**: 검색 기능을 상단 또는 접을 수 있는 형태로 변경

### 2. 배속 조절 일관성 문제
- **문제**: 어떤 영상에서는 배속이 작동하고, 어떤 영상에서는 작동하지 않음
- **원인**: YouTube IFrame API의 제한 또는 영상별 권한 차이
- **현재 상태**: 조사 필요

### 3. 반응형 레이아웃 부재
- **문제**: 태블릿에서 가로/세로 모드 전환 시 최적화된 레이아웃 없음
- **이전 시도**: 가로모드(영상 크게), 세로모드(영상 상단+노트 하단) 구현했으나 기능 충돌 발생
- **해결 필요**: 방향 전환 시 안정적인 상태 유지

## 🔮 향후 추가할 기능

### 단기 목표 (기본 사용성 개선)
- [ ] 레이아웃 개선 (검색 위치 변경)
- [ ] 배속 조절 안정화
- [ ] 반응형 레이아웃 구현

### 중기 목표 (고급 기능)
- [ ] 드래그 기반 영상 조작
  - 클릭: 일시정지/재생
  - 드래그: 좌우로 영상 구간 이동
  - 배속: 0.1 단위 세밀 조절
- [ ] 영상 구간 선택 및 클립 저장
  - 시작점-끝점 지정으로 구간 선택
  - 해당 구간과 아이디어를 세트로 저장
  - 나중에 설명용으로 활용 가능

### 장기 목표 (데이터 관리)
- [ ] 여러 영상의 노트 관리 시스템
- [ ] 노트 검색 및 필터링
- [ ] 노트 내보내기 (Markdown, PDF 등)
- [ ] 태그 및 카테고리 기능

## 📝 개발 히스토리

### 문제가 되었던 수정 패턴
1. **전체 새로 작성**: 기존 수정사항을 무시하고 처음부터 다시 작성
2. **반복 작업**: 이전 수정사항을 기억하지 못해 같은 작업 반복
3. **요청 의도 혼동**: 직접 수정 vs 방법 안내 요청 구분 부족

### 개선된 작업 방식
- 수정 전 명확한 의도 확인
- 부분 수정으로 기존 코드 보존
- 변경사항을 이 문서에 기록
- 문제 발생 시 원인 분석 후 다른 접근법 시도

## 🔧 기술적 고려사항

### YouTube API 제한사항
- 일부 영상에서 배속 조절 불가
- 임베드 제한이 있는 영상 존재
- API 키 보안 (서버사이드 처리 필수)

### 브라우저 호환성
- 모바일 브라우저에서의 터치 인터페이스
- 가상 키보드 출현 시 레이아웃 변화 대응

## 🎯 앱의 더 큰 비전

### 두 가지 주요 사용 모드
1. **유튜브 연동 모드**: 로그인된 유튜브에서 영상 시청 중 → 노트 모드로 자연스럽게 전환
2. **독립 검색 모드**: 노트 앱에서 직접 영상 검색 → 여러 결과 중 선택 → 노트와 함께 작업

### 영상 소실 문제 대처 방안
- **문제**: 오래된 영상이 삭제되거나 비공개로 전환될 때 노트 무효화
- **대처 방향**:
  - 중요 구간을 별도 저장 (백업 시스템)
  - 메타데이터 보존 (영상 소실되어도 노트는 유지)
  - 영상 상태 추적 및 알림
  - 대체 소스 찾기 기능

### 검색 기능 개선 방향
- **현재**: 첫 번째 결과만 자동 재생
- **개선**: 검색 결과 목록 표시 → 사용자 선택 → 재생

## 🔍 핵심 기능 검증 필요사항

### 우선 검증할 기능들
1. **타임스탬프 ↔ 영상 시간 동기화** 정확성 테스트
2. **데이터 저장** (영상 + 타임스탬프 + 노트) 기능 확인
3. **가상키보드** 구현으로 화면 안정성 (화면 왔다갔다 방지)

### 새로운 아이디어들
- **노트 영역에 재생/일시정지 버튼 추가**: 영상 클릭 대신 노트 하단에서 바로 제어
  - 장점: 노트 작성 중 손 이동 최소화, 더 빠른 영상 제어
  - 사용 시나리오: 영상 보다가 → 노트 영역에서 일시정지 → 메모 작성 → 재생 재개

### 아이디어 정리 단계
- 현재는 구현보다는 **설계 방향 정리**가 우선
- 무조건적인 수정이 아닌 **대화를 통한 방향성 설정**
- 사용자 요구사항과 기술적 제약사항 균형점 찾기

## 📝 개발 작업일지

### 타임스탬프 클릭 문제 해결 과정

**문제 발견:**
- URL 입력 기능 제거 후 타임스탬프 클릭이 작동하지 않음
- 알림 메시지도 나타나지 않아 이벤트 자체가 작동하지 않는 것으로 판단

**문제 분석:**
1. 검색 기능을 목록형으로 변경한 것은 직접적 영향 없음
2. YouTubePlayer 컴포넌트에서 children 제거 과정에서 문제 발생 가능성
3. 타임스탬프 클릭 이벤트 로직 자체 점검 필요

**해결 과정:**
1. **이벤트 충돌 해결**: onClick에서 onDoubleClick으로 변경
   - 일반 클릭: 텍스트 편집용
   - 더블클릭: 타임스탬프 이동용
2. **로직 개선**: 복잡한 텍스트 분할 로직을 단순화
3. **결과**: 더블클릭으로 타임스탬프 이동 기능 정상 작동

**교훈:**
- textarea에서 onClick 이벤트는 일반 편집과 충돌 가능
- 기능별 이벤트 분리가 사용성 향상에 도움

### 가상키보드 대응 아이디어 발전 과정

**초기 문제 인식:**
- 모바일에서 가상키보드 올라올 때 UI 불편함
- 손가락 가동 범위에 따른 타이핑 어려움
- 특수키/영어/숫자 입력의 번거로움

**1차 접근 - 레이아웃 조정:**
- 키보드 올라올 때 노트 영역 크기 축소
- 영상 플레이어 위치 고정
- 전체 컨테이너 높이 조정

**문제점 발견:**
- 영상이 가려지는 문제
- 노트 영역이 너무 작아짐
- 사용자 경험 저하

**2차 접근 - 플로팅 메모창:**
- **핵심 아이디어**: 새로운 작은 메모창이 키보드 위에 떠있는 형태
- **장점**: 
  - 영상 전혀 가려지지 않음
  - 원래 메모창 크기 유지 (200px, 안정감)
  - 실시간 연동으로 데이터 동기화
- **구현**: position: fixed로 키보드 바로 위에 배치

**기술적 해결:**
1. **키보드 감지**: Visual Viewport API + window resize 폴백
2. **실시간 연동**: 같은 state 공유로 두 메모창 동기화
3. **부드러운 전환**: CSS transition으로 자연스러운 등장/사라짐

**최종 결과:**
- 영상 시청 방해 없이 빠른 메모 가능
- 키보드 사라지면 자동으로 원래 상태 복귀
- 타임스탬프 기능도 플로팅 창에서 사용 가능

**향후 가상키보드 개선 아이디어:**
- 키별 위치 미세조정 및 크기 변경 설정
- 사용자별 타이핑 패턴 분석 기반 최적 배치
- 스와이프나 길게 누르기로 특수키 빠른 입력

### 플로팅 영상 실험 및 롤백 과정

**새로운 아이디어 - 영상 플로팅:**
- 플로팅 메모창 대신 영상을 플로팅으로 변경
- 키보드 올라올 때 영상이 상단 중앙에 가로 넓게 배치
- 메모창은 전체 화면 활용하여 편안한 타이핑

**구현 시도:**
- 상단 중앙 플로팅 영상 플레이어 구현
- 좌측: 재생/일시정지 + 배속 조절 버튼
- 우측: 타임스탬프 버튼 (클립보드 복사 기능)
- 키보드 감지 시 영상 플레이어 위치 전환

**발생한 문제점들:**
1. **화면 크기 문제**: 배속 버튼까지 포함하여 영상 크기가 너무 작아짐
2. **YouTube API 연결 문제**: 플로팅으로 바뀌면서 DOM 연결 끊어짐
   - 콘솔 경고: "The YouTube player is not attached to the DOM"
3. **UX 문제**: 검색할 때도 플로팅 바가 나타나서 방해
4. **트리거 문제**: 메모창 포커스가 아닌 키보드 감지로 작동해서 의도와 다름

**롤백 결정:**
- 현재 구현은 사용성을 오히려 저하시킴
- 원래의 플로팅 메모창 방식이 더 실용적이었음
- YouTube API 연결 문제로 인한 기능 장애

**대안 방향 고려:**
1. **1차 접근**: 현재 방식 개선
   - 배속 버튼 제거하여 영상 크기 확보
   - 메모창 포커스 감지로 트리거 변경
   - YouTube 플레이어 DOM 연결 문제 해결

2. **2차 접근**: 완전히 다른 레이아웃
   - 처음부터 플로팅 영상으로 시작
   - 검색/배속/메모를 메인 화면에 재배치

**교훈:**
- 혁신적인 아이디어도 기술적 제약과 사용성을 고려해야 함
- YouTube API의 DOM 의존성 문제 사전 검토 필요
- 단계별 점진적 개선이 급진적 변경보다 안전함

## 🚀 프로토타입 설계 방향

### 단순화 전략
- **URL 입력 제거**: 복잡성 줄이고 검색에만 집중
- **검색 기능을 영상 위로 이동**: 영상-노트 간 거리 최소화, 시선 이동 줄이기
- **재생속도 표준화**: 유튜브 기본 설정 따라가기 (0.25 ~ 2.0, 0.25 단위)

### 레이아웃 개선 효과
- 검색 → 영상 → 노트 순서로 자연스러운 흐름
- 중앙의 빈 공간 제거로 화면 효율성 증대
- 사용자 시선이 위아래로만 이동

## 📋 다음 작업 우선순위
1. 핵심 기능 검증 (타임스탬프, 저장, 가상키보드)
2. 프로토타입 구현 (URL 제거, 검색 위치 변경, 재생속도 표준화)
3. 검색 결과 목록 기능 설계
4. 유튜브 연동 방식 설계

---

*최종 수정: 2025-01-26*
*작성자: 개발팀*