// 카테고리별 색상 시스템 유틸리티

// 미리 정의된 색상 팔레트
const 색상팔레트 = [
  { 배경: '#FFE5E5', 테두리: '#FF6B6B', 텍스트: '#C92A2A' }, // 빨강
  { 배경: '#E8F5E8', 테두리: '#51CF66', 텍스트: '#2F9E44' }, // 초록
  { 배경: '#E3F2FD', 테두리: '#42A5F5', 텍스트: '#1E88E5' }, // 파랑
  { 배경: '#FFF3E0', 테두리: '#FF9800', 텍스트: '#F57C00' }, // 주황
  { 배경: '#F3E5F5', 테두리: '#AB47BC', 텍스트: '#8E24AA' }, // 보라
  { 배경: '#E0F2F1', 테두리: '#26A69A', 텍스트: '#00695C' }, // 청록
  { 배경: '#FFF8E1', 테두리: '#FFCA28', 텍스트: '#F9A825' }, // 노랑
  { 배경: '#EFEBE9', 테두리: '#8D6E63', 텍스트: '#5D4037' }, // 갈색
  { 배경: '#FAFAFA', 테두리: '#9E9E9E', 텍스트: '#424242' }, // 회색
  { 배경: '#E1F5FE', 테두리: '#00BCD4', 텍스트: '#0097A7' }, // 시안
];

// 문자열 해시 함수
const 문자열해시 = (문자열: string): number => {
  let 해시값 = 0;
  for (let i = 0; i < 문자열.length; i++) {
    const 문자코드 = 문자열.charCodeAt(i);
    해시값 = ((해시값 << 5) - 해시값) + 문자코드;
    해시값 = 해시값 & 해시값; // 32비트 정수로 변환
  }
  return Math.abs(해시값);
};

// 카테고리 색상 가져오기
export const 카테고리색상가져오기 = (카테고리: string) => {
  const 해시값 = 문자열해시(카테고리);
  const 색상인덱스 = 해시값 % 색상팔레트.length;
  return 색상팔레트[색상인덱스];
};

// 카테고리 조합 키 생성
export const 조합키생성 = (카테고리목록: string[]): string => {
  return 카테고리목록.sort().join(',');
};

// 카테고리 조합 이름 가져오기
export const 조합이름가져오기 = (
  카테고리목록: string[], 
  조합설정?: { 조합자동명명: boolean; 조합목록: { [key: string]: string } }
): string => {
  if (카테고리목록.length === 0) return '';
  if (카테고리목록.length === 1) return 카테고리목록[0];
  
  const 조합키 = 조합키생성(카테고리목록);
  
  // 저장된 조합 이름이 있으면 사용
  if (조합설정?.조합목록[조합키]) {
    return 조합설정.조합목록[조합키];
  }
  
  // 없으면 쉼표로 연결
  return 카테고리목록.join(', ');
};

// 카테고리 조합 색상 가져오기 (첫 번째 카테고리 기준)
export const 조합색상가져오기 = (카테고리목록: string[]) => {
  if (카테고리목록.length === 0) return 색상팔레트[0];
  return 카테고리색상가져오기(카테고리목록[0]);
};

// 카테고리 조합 저장
export const 카테고리조합저장 = (
  카테고리목록: string[],
  조합이름: string,
  기존조합설정?: { 조합자동명명: boolean; 조합목록: { [key: string]: string } }
) => {
  const 조합키 = 조합키생성(카테고리목록);
  const 기존목록 = 기존조합설정?.조합목록 || {};
  
  return {
    조합자동명명: 기존조합설정?.조합자동명명 ?? true,
    조합목록: {
      ...기존목록,
      [조합키]: 조합이름
    }
  };
};

// 저장된 조합 이름 확인
export const 저장된조합이름확인 = (
  카테고리목록: string[],
  조합설정?: { 조합자동명명: boolean; 조합목록: { [key: string]: string } }
): string | undefined => {
  if (카테고리목록.length <= 1) return undefined;
  
  const 조합키 = 조합키생성(카테고리목록);
  return 조합설정?.조합목록[조합키];
};